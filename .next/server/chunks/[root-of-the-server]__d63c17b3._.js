module.exports=[14747,(e,r,t)=>{r.exports=e.x("path",()=>require("path"))},22734,(e,r,t)=>{r.exports=e.x("fs",()=>require("fs"))},46786,(e,r,t)=>{r.exports=e.x("os",()=>require("os"))},90190,(e,r,t)=>{"use strict";var o=Object.create,n=Object.defineProperty,i=Object.getOwnPropertyDescriptor,l=Object.getOwnPropertyNames,a=Object.getPrototypeOf,c=Object.prototype.hasOwnProperty,s=(e,r,t,o)=>{if(r&&"object"==typeof r||"function"==typeof r)for(let a of l(r))c.call(e,a)||a===t||n(e,a,{get:()=>r[a],enumerable:!(o=i(r,a))||o.enumerable});return e},u=(e,r,t)=>(t=null!=e?o(a(e)):{},s(!r&&e&&e.__esModule?t:n(t,"default",{value:e,enumerable:!0}),e)),f={},p={findRootDir:()=>w,getUserDataDir:()=>g};for(var d in p)n(f,d,{get:p[d],enumerable:!0});r.exports=s(n({},"__esModule",{value:!0}),f);var y=u(e.r(14747)),h=u(e.r(22734)),k=u(e.r(46786)),O=e.r(91447);function w(){try{let e=process.cwd();for(;e!==y.default.dirname(e);){let r=y.default.join(e,".vercel");if(h.default.existsSync(r))return e;e=y.default.dirname(e)}}catch(e){throw new O.VercelOidcTokenError("Token refresh only supported in node server environments")}return null}function g(){if(process.env.XDG_DATA_HOME)return process.env.XDG_DATA_HOME;switch(k.default.platform()){case"darwin":return y.default.join(k.default.homedir(),"Library/Application Support");case"linux":return y.default.join(k.default.homedir(),".local/share");case"win32":if(process.env.LOCALAPPDATA)return process.env.LOCALAPPDATA;return null;default:return null}}},21409,(e,r,t)=>{"use strict";var o=Object.create,n=Object.defineProperty,i=Object.getOwnPropertyDescriptor,l=Object.getOwnPropertyNames,a=Object.getPrototypeOf,c=Object.prototype.hasOwnProperty,s=(e,r,t,o)=>{if(r&&"object"==typeof r||"function"==typeof r)for(let a of l(r))c.call(e,a)||a===t||n(e,a,{get:()=>r[a],enumerable:!(o=i(r,a))||o.enumerable});return e},u=(e,r,t)=>(t=null!=e?o(a(e)):{},s(!r&&e&&e.__esModule?t:n(t,"default",{value:e,enumerable:!0}),e)),f={},p={isValidAccessToken:()=>v,readAuthConfig:()=>w,writeAuthConfig:()=>g};for(var d in p)n(f,d,{get:p[d],enumerable:!0});r.exports=s(n({},"__esModule",{value:!0}),f);var y=u(e.r(22734)),h=u(e.r(14747)),k=e.r(71329);function O(){let e=(0,k.getVercelDataDir)();if(!e)throw Error(`Unable to find Vercel CLI data directory. Your platform: ${process.platform}. Supported: darwin, linux, win32.`);return h.join(e,"auth.json")}function w(){try{let e=O();if(!y.existsSync(e))return null;let r=y.readFileSync(e,"utf8");if(!r)return null;return JSON.parse(r)}catch(e){return null}}function g(e){let r=O(),t=h.dirname(r);y.existsSync(t)||y.mkdirSync(t,{mode:504,recursive:!0}),y.writeFileSync(r,JSON.stringify(e,null,2),{mode:384})}function v(e){if(!e.token)return!1;if("number"!=typeof e.expiresAt)return!0;let r=Math.floor(Date.now()/1e3);return e.expiresAt>=r}},27139,(e,r,t)=>{"use strict";var o=Object.defineProperty,n=Object.getOwnPropertyDescriptor,i=Object.getOwnPropertyNames,l=Object.prototype.hasOwnProperty,a={},c={processTokenResponse:()=>h,refreshTokenRequest:()=>y};for(var s in c)o(a,s,{get:c[s],enumerable:!0});r.exports=((e,r,t,a)=>{if(r&&"object"==typeof r||"function"==typeof r)for(let t of i(r))l.call(e,t)||void 0===t||o(e,t,{get:()=>r[t],enumerable:!(a=n(r,t))||a.enumerable});return e})(o({},"__esModule",{value:!0}),a);var u=e.r(46786);let f=`@vercel/oidc node-${process.version} ${(0,u.platform)()} (${(0,u.arch)()}) ${(0,u.hostname)()}`,p=null;async function d(){if(p)return p;let e=await fetch("https://vercel.com/.well-known/openid-configuration",{headers:{"user-agent":f}});if(!e.ok)throw Error("Failed to discover OAuth endpoints");let r=await e.json();if(!r||"string"!=typeof r.token_endpoint)throw Error("Invalid OAuth discovery response");let t=r.token_endpoint;return p=t,t}async function y(e){let r=await d();return await fetch(r,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","user-agent":f},body:new URLSearchParams({client_id:"cl_HYyOPBNtFMfHhaUn9L4QPfTZz6TP47bp",grant_type:"refresh_token",...e})})}async function h(e){let r=await e.json();return e.ok?"object"!=typeof r||null===r?[Error("Invalid token response")]:"string"!=typeof r.access_token?[Error("Missing access_token in response")]:"Bearer"!==r.token_type?[Error("Invalid token_type in response")]:"number"!=typeof r.expires_in?[Error("Missing expires_in in response")]:[null,r]:[Error("object"==typeof r&&r&&"error"in r?String(r.error):"Token refresh failed")]}},71329,(e,r,t)=>{"use strict";var o=Object.create,n=Object.defineProperty,i=Object.getOwnPropertyDescriptor,l=Object.getOwnPropertyNames,a=Object.getPrototypeOf,c=Object.prototype.hasOwnProperty,s=(e,r,t,o)=>{if(r&&"object"==typeof r||"function"==typeof r)for(let a of l(r))c.call(e,a)||a===t||n(e,a,{get:()=>r[a],enumerable:!(o=i(r,a))||o.enumerable});return e},u=(e,r,t)=>(t=null!=e?o(a(e)):{},s(!r&&e&&e.__esModule?t:n(t,"default",{value:e,enumerable:!0}),e)),f={},p={assertVercelOidcTokenResponse:()=>m,findProjectInfo:()=>T,getTokenPayload:()=>D,getVercelCliToken:()=>j,getVercelDataDir:()=>v,getVercelOidcToken:()=>b,isExpired:()=>x,loadToken:()=>_,saveToken:()=>P};for(var d in p)n(f,d,{get:p[d],enumerable:!0});r.exports=s(n({},"__esModule",{value:!0}),f);var y=u(e.r(14747)),h=u(e.r(22734)),k=e.r(91447),O=e.r(90190),w=e.r(21409),g=e.r(27139);function v(){let e=(0,O.getUserDataDir)();return e?y.join(e,"com.vercel.cli"):null}async function j(){let e=(0,w.readAuthConfig)();if(!e)return null;if((0,w.isValidAccessToken)(e))return e.token||null;if(!e.refreshToken)return(0,w.writeAuthConfig)({}),null;try{let r=await (0,g.refreshTokenRequest)({refresh_token:e.refreshToken}),[t,o]=await (0,g.processTokenResponse)(r);if(t||!o)return(0,w.writeAuthConfig)({}),null;let n={token:o.access_token,expiresAt:Math.floor(Date.now()/1e3)+o.expires_in};return o.refresh_token&&(n.refreshToken=o.refresh_token),(0,w.writeAuthConfig)(n),n.token??null}catch(e){return(0,w.writeAuthConfig)({}),null}}async function b(e,r,t){let o=`https://api.vercel.com/v1/projects/${r}/token?source=vercel-oidc-refresh${t?`&teamId=${t}`:""}`,n=await fetch(o,{method:"POST",headers:{Authorization:`Bearer ${e}`}});if(!n.ok)throw new k.VercelOidcTokenError(`Failed to refresh OIDC token: ${n.statusText}`);let i=await n.json();return m(i),i}function m(e){if(!e||"object"!=typeof e)throw TypeError("Vercel OIDC token is malformed. Expected an object. Please run `vc env pull` and try again");if(!("token"in e)||"string"!=typeof e.token)throw TypeError("Vercel OIDC token is malformed. Expected a string-valued token property. Please run `vc env pull` and try again")}function T(){let e=(0,O.findRootDir)();if(!e)throw new k.VercelOidcTokenError("Unable to find project root directory. Have you linked your project with `vc link?`");let r=y.join(e,".vercel","project.json");if(!h.existsSync(r))throw new k.VercelOidcTokenError("project.json not found, have you linked your project with `vc link?`");let t=JSON.parse(h.readFileSync(r,"utf8"));if("string"!=typeof t.projectId&&"string"!=typeof t.orgId)throw TypeError("Expected a string-valued projectId property. Try running `vc link` to re-link your project.");return{projectId:t.projectId,teamId:t.orgId}}function P(e,r){let t=(0,O.getUserDataDir)();if(!t)throw new k.VercelOidcTokenError("Unable to find user data directory. Please reach out to Vercel support.");let o=y.join(t,"com.vercel.token",`${r}.json`),n=JSON.stringify(e);h.mkdirSync(y.dirname(o),{mode:504,recursive:!0}),h.writeFileSync(o,n),h.chmodSync(o,432)}function _(e){let r=(0,O.getUserDataDir)();if(!r)throw new k.VercelOidcTokenError("Unable to find user data directory. Please reach out to Vercel support.");let t=y.join(r,"com.vercel.token",`${e}.json`);if(!h.existsSync(t))return null;let o=JSON.parse(h.readFileSync(t,"utf8"));return m(o),o}function D(e){let r=e.split(".");if(3!==r.length)throw new k.VercelOidcTokenError("Invalid token. Please run `vc env pull` and try again");let t=r[1].replace(/-/g,"+").replace(/_/g,"/"),o=t.padEnd(t.length+(4-t.length%4)%4,"=");return JSON.parse(Buffer.from(o,"base64").toString("utf8"))}function x(e){return 1e3*e.exp<Date.now()}},80800,(e,r,t)=>{"use strict";var o=Object.defineProperty,n=Object.getOwnPropertyDescriptor,i=Object.getOwnPropertyNames,l=Object.prototype.hasOwnProperty,a={},c={refreshToken:()=>p};for(var s in c)o(a,s,{get:c[s],enumerable:!0});r.exports=((e,r,t,a)=>{if(r&&"object"==typeof r||"function"==typeof r)for(let t of i(r))l.call(e,t)||void 0===t||o(e,t,{get:()=>r[t],enumerable:!(a=n(r,t))||a.enumerable});return e})(o({},"__esModule",{value:!0}),a);var u=e.r(91447),f=e.r(71329);async function p(){let{projectId:e,teamId:r}=(0,f.findProjectInfo)(),t=(0,f.loadToken)(e);if(!t||(0,f.isExpired)((0,f.getTokenPayload)(t.token))){let o=await (0,f.getVercelCliToken)();if(!o)throw new u.VercelOidcTokenError("Failed to refresh OIDC token: Log in to Vercel CLI and link your project with `vc link`");if(!e)throw new u.VercelOidcTokenError("Failed to refresh OIDC token: Try re-linking your project with `vc link`");if(!(t=await (0,f.getVercelOidcToken)(o,e,r)))throw new u.VercelOidcTokenError("Failed to refresh OIDC token");(0,f.saveToken)(t,e)}process.env.VERCEL_OIDC_TOKEN=t.token}}];

//# sourceMappingURL=%5Broot-of-the-server%5D__d63c17b3._.js.map